Изначально по привычке все делал в ООП стиле, пересмотрел материал и исправил